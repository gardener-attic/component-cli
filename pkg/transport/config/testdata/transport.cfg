meta:
  version: v1

processors:
- name: 'my-oci-filter'
  type: 'OciArtifactFilter'
  spec:
    removePatterns:
    - 'bin/*'
- name: 'my-labeler'
  type: 'ResourceLabeler'
  spec:
    labels:
    - name: 'label-name'
      value: 'label-value'
- name: 'my-extension'
  type: 'Executable'
  spec:
    bin: '/path/to/processor'
    args:
    - '-arg1=test'
    env:
      key1: val1

downloaders:
- name: 'oci-artifact-dl'
  type: 'OciArtifactDownloader'
  filters:
  - type: 'ResourceTypeFilter'
    spec:
      includeResourceTypes:
      - 'ociImage'
- name: 'local-oci-blob-dl'
  type: 'LocalOciBlobDownloader'
  filters:
  - type: 'AccessTypeFilter'
    spec:
      includeAccessTypes:
      - 'localOciBlob'

uploaders:
- name: 'oci-artifact-ul'
  type: 'OciArtifactUploader'
  spec:
    baseUrl: 'my-target-registry.com/test'
    keepSourceRepo: false
  filters:
  - type: 'ResourceTypeFilter'
    spec:
      includeResourceTypes:
      - 'ociImage'
- name: 'local-oci-blob-ul'
  type: 'LocalOciBlobUploader'
  filters:
  - type: 'AccessTypeFilter'
    spec:
      includeAccessTypes:
      - 'localOciBlob'

rules:
- name: 'generic-image-filtering'
  processors:
  - name: 'my-oci-filter'
    type: 'processor'
  filters:
  - type: 'ResourceTypeFilter'
    spec:
      includeResourceTypes:
      - 'ociImage'
- name: 'my-component-labeling'
  processors:
  - name: 'my-labeler'
    type: 'processor'
  filters:
  - type: 'ComponentNameFilter'
    spec:
      includeComponentNames:
      - 'github.com/my-component'
- name: 'my-component-special-image-processing'
  processors:
  - name: 'my-extension'
    type: 'processor'
  filters:
  - type: 'ComponentNameFilter'
    spec:
      includeComponentNames:
      - 'github.com/my-component'
  - type: 'ResourceTypeFilter'
    spec:
      includeResourceTypes:
      - 'ociImage'